import{getOwner as M,getListener as X,onCleanup as F,sharedConfig as b,createSignal as L,startTransition as v,createMemo as K,$TRACK as z}from"solid-js";import{getRequestEvent as C,isServer as g}from"solid-js/web";import{b as V,g as Y,f as Q,m as Z,h as ee}from"./routing-BfDgGOS4.js";import{provideRequestEvent as te}from"solid-js/web/storage";import{H3Event as x,getRequestIP as se,setResponseStatus as ne,getResponseStatus as re,getResponseStatusText as oe,getResponseHeader as ae,setResponseHeader as ie,removeResponseHeader as ce,appendResponseHeader as ue,getResponseHeaders as de,getRequestURL as le,getRequestWebStream as fe,useSession as he,setHeader as pe,parseCookies as ge,getCookie as ye,setCookie as me,getHeader as we,sendWebResponse as Se}from"h3";import{getContext as Re}from"unctx";import{AsyncLocalStorage as be}from"node:async_hooks";function at(e){return e}function Ce(e){let t;const s=N(e),n={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(s,{...n,body:e.node.req.body}):new Request(s,{...n,get body(){return t||(t=xe(e),t)}})}function $e(e){return e.web??={request:Ce(e),url:N(e)},e.web.request}function Ae(){return Pe()}const D=Symbol("$HTTPEvent");function Ee(e){return typeof e=="object"&&(e instanceof x||e?.[D]instanceof x||e?.__is_event__===!0)}function c(e){return function(...t){let s=t[0];if(Ee(s))t[0]=s instanceof x||s.__is_event__?s:s[D];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(s=Ae(),!s)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");t.unshift(s)}return e(...t)}}const N=c(le),Te=c(se),q=c(ne),k=c(re),ve=c(oe),T=c(de),j=c(ae),_e=c(ie),W=c(ue),it=c(ge),ct=c(ye),ut=c(me),He=c(he),dt=c(Se),lt=c(pe),ft=c(we),xe=c(fe),Oe=c(ce),Le=c($e);function Ue(){return Re("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:be})}function Pe(){return Ue().use().event}const H="solidFetchEvent";function qe(e){return{request:Le(e),response:Ie(e),clientAddress:Te(e),locals:{},nativeEvent:e}}function ke(e){return{...e}}function ht(e){if(!e.context[H]){const t=qe(e);e.context[H]=t}return e.context[H]}function pt(e,t){for(const[s,n]of t.entries())W(e,s,n)}class je{event;constructor(t){this.event=t}get(t){const s=j(this.event,t);return Array.isArray(s)?s.join(", "):s||null}has(t){return this.get(t)!==null}set(t,s){return _e(this.event,t,s)}delete(t){return Oe(this.event,t)}append(t,s){W(this.event,t,s)}getSetCookie(){const t=j(this.event,"Set-Cookie");return Array.isArray(t)?t:[t]}forEach(t){return Object.entries(T(this.event)).forEach(([s,n])=>t(Array.isArray(n)?n.join(", "):n,s,this))}entries(){return Object.entries(T(this.event)).map(([t,s])=>[t,Array.isArray(s)?s.join(", "):s])[Symbol.iterator]()}keys(){return Object.keys(T(this.event))[Symbol.iterator]()}values(){return Object.values(T(this.event)).map(t=>Array.isArray(t)?t.join(", "):t)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Ie(e){return{get status(){return k(e)},set status(t){q(e,t)},get statusText(){return ve(e)},set statusText(t){q(e,k(e),t)},headers:new je(e)}}function _(e,t,s){if(typeof e!="function")throw new Error("Export from a 'use server' module must be a function");const n="";return new Proxy(e,{get(r,o,u){return o==="url"?`${n}/_server?id=${encodeURIComponent(t)}&name=${encodeURIComponent(s)}`:o==="GET"?u:r[o]},apply(r,o,u){const h=C();if(!h)throw new Error("Cannot call server function outside of a request");const w=ke(h);return w.locals.serverFunctionMeta={id:t+"#"+s},w.serverOnly=!0,te(w,()=>e.apply(o,u))}})}const Me="Location",Fe=5e3,De=18e4;let A=new Map;g||setInterval(()=>{const e=Date.now();for(let[t,s]of A.entries())!s[4].count&&e-s[0]>De&&A.delete(t)},3e5);function E(){if(!g)return A;const e=C();if(!e)throw new Error("Cannot find cache context");return(e.router||(e.router={})).cache||(e.router.cache=new Map)}function Ne(e,t=!0){return v(()=>{const s=Date.now();G(e,n=>{t&&(n[0]=0),n[4][1](s)})})}function G(e,t){e&&!Array.isArray(e)&&(e=[e]);for(let s of A.keys())(e===void 0||B(s,e))&&t(A.get(s))}function $(e,t){e.GET&&(e=e.GET);const s=(...n)=>{const r=E(),o=Y(),u=Q(),w=M()?V():void 0,S=Date.now(),p=t+O(n);let a=r.get(p),R;if(g){const i=C();if(i){const l=(i.router||(i.router={})).dataOnly;if(l){const m=i&&(i.router.data||(i.router.data={}));if(m&&p in m)return m[p];if(Array.isArray(l)&&!B(p,l))return m[p]=void 0,Promise.resolve()}}}if(X()&&!g&&(R=!0,F(()=>a[4].count--)),a&&a[0]&&(g||o==="native"||a[4].count||Date.now()-a[0]<Fe)){R&&(a[4].count++,a[4][0]()),a[3]==="preload"&&o!=="preload"&&(a[0]=S);let i=a[1];return o!=="preload"&&(i="then"in a[1]?a[1].then(y(!1),y(!0)):y(!1)(a[1]),!g&&o==="navigate"&&v(()=>a[4][1](a[0]))),u&&"then"in i&&i.catch(()=>{}),i}let d;if(!g&&b.has&&b.has(p)?(d=b.load(p),delete globalThis._$HY.r[p]):d=e(...n),a?(a[0]=S,a[1]=d,a[3]=o,!g&&o==="navigate"&&v(()=>a[4][1](a[0]))):(r.set(p,a=[S,d,,o,L(S)]),a[4].count=0),R&&(a[4].count++,a[4][0]()),g){const i=C();if(i&&i.router.dataOnly)return i.router.data[p]=d}if(o!=="preload"&&(d="then"in d?d.then(y(!1),y(!0)):y(!1)(d)),u&&"then"in d&&d.catch(()=>{}),g&&b.context&&b.context.async&&!b.context.noHydrate){const i=C();(!i||!i.serverOnly)&&b.context.serialize(p,d)}return d;function y(i){return async l=>{if(l instanceof Response){const m=l.headers.get(Me);if(m!==null){if(w&&m.startsWith("/"))v(()=>{w(m,{replace:!0})});else if(!g)window.location.href=m;else if(g){const P=C();P&&(P.response={status:302,headers:new Headers({Location:m})})}return}l.customBody&&(l=await l.customBody())}if(i)throw l;return a[2]=l,l}}};return s.keyFor=(...n)=>t+O(n),s.key=t,s}$.get=e=>E().get(e)[2];$.set=(e,t)=>{const s=E(),n=Date.now();let r=s.get(e);r?(r[0]=n,r[1]=Promise.resolve(t),r[2]=t,r[3]="preload"):(s.set(e,r=[n,Promise.resolve(t),t,"preload",L(n)]),r[4].count=0)};$.delete=e=>E().delete(e);$.clear=()=>E().clear();function B(e,t){for(let s of t)if(s&&e.startsWith(s))return!0;return!1}function O(e){return JSON.stringify(e,(t,s)=>We(s)?Object.keys(s).sort().reduce((n,r)=>(n[r]=s[r],n),{}):s)}function We(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}const I=new Map;function Ge(e,t){const s=ee(),n=K(()=>s.submissions[0]().filter(r=>r.url===e.base&&!0));return new Proxy([],{get(r,o){return o===z?n():o==="pending"?n().some(u=>!u.result):n()[o]},has(r,o){return o in n()}})}function gt(e,t){const s=Ge(e);return new Proxy({},{get(n,r){return s.length===0&&r==="clear"||r==="retry"?()=>{}:s[s.length-1]?.[r]}})}function yt(e,t={}){function s(...o){const u=this.r,h=this.f,w=(u.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...o),[S,p]=L();let a;function R(d){return async y=>{const i=await Je(y,d,u.navigatorFactory());let l=null;if(n.onComplete?.({...a,result:i?.data,error:i?.error,pending:!1,retry(){return l=a.retry()}}),l)return l;if(!i)return a.clear();if(p(i),i.error&&!h)throw i.error;return i.data}}return u.submissions[1](d=>[...d,a={input:o,url:r,get result(){return S()?.data},get error(){return S()?.error},get pending(){return!S()},clear(){u.submissions[1](y=>y.filter(i=>i!==a))},retry(){return p(void 0),e(...o).then(R(),R(!0))}}]),w.then(R(),R(!0))}const n=typeof t=="string"?{name:t}:t,r=e.url||n.name&&`https://action/${n.name}`||(g?"":`https://action/${Be(e.toString())}`);return s.base=r,J(s,r)}function J(e,t){return e.toString=()=>{if(!t)throw new Error("Client Actions need explicit names if server rendered");return t},e.with=function(...s){const n=function(...o){return e.call(this,...s,...o)};n.base=e.base;const r=new URL(t,Z);return r.searchParams.set("args",O(s)),J(n,(r.origin==="https://action"?r.origin:"")+r.pathname+r.search)},e.url=t,g||(I.set(t,e),M()&&F(()=>I.delete(t))),e}const Be=e=>e.split("").reduce((t,s)=>(t<<5)-t+s.charCodeAt(0)|0,0);async function Je(e,t,s){let n,r,o,u;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(o=e.headers.get("X-Revalidate").split(",")),e.customBody&&(n=r=await e.customBody(),e.headers.has("X-Single-Flight")&&(n=n._$value,delete r._$value,u=Object.keys(r))),e.headers.has("Location")){const h=e.headers.get("Location")||"/";h.startsWith("http")?window.location.href=h:s(h)}}else{if(t)return{error:e};n=e}return G(o,h=>h[0]=0),u&&u.forEach(h=>$.set(h,r[h])),await Ne(o,!1),n!=null?{data:n}:void 0}function mt(e,t=302){let s,n;typeof t=="number"?s={status:t}:({revalidate:n,...s}=t,typeof s.status>"u"&&(s.status=302));const r=new Headers(s.headers);return r.set("Location",e),n!==void 0&&r.set("X-Revalidate",n.toString()),new Response(null,{...s,headers:r})}function wt(e,t={}){const{revalidate:s,...n}=t,r=new Headers(n.headers);s!==void 0&&r.set("X-Revalidate",s.toString()),r.set("Content-Type","application/json");const o=new Response(JSON.stringify(e),{...n,headers:r});return o.customBody=()=>e,o}const Xe="900da1c8f697beefdab33bc8ff480a1448f58fd015ec3108dc3b323bdaa0c245",Ke=3600*24,ze=_(function(){return He({name:"oaq_explorer_session",password:Xe,maxAge:Ke})},"src_auth_session_ts--getSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),U=ze,Ve=_(async()=>{const{data:e}=await U();return e.usersId?e:null},"src_auth_session_ts--getSessionUser_query","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),St=$(Ve,"session-user"),Ye=_(async function(t,s){const n=await U();await n.update(r=>(r.usersId=t,r)),await n.update(r=>{r.maxAge=s})},"src_auth_session_ts--setSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),Rt=Ye,Qe=_(async function(){await(await U()).update(s=>s.usersId=void 0)},"src_auth_session_ts--clearSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),bt=Qe,f=process.env.REST_API_URL||"http://localhost:8080",Ct={createUser:async e=>await fetch(`${f}/users`,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}),getUserById:async e=>await fetch(`${f}/users/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByEmailAddress:async e=>await fetch(`${f}/users/email/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByVerificationCode:async e=>await fetch(`${f}/users/verification-code/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),verifyUser:async e=>await fetch(`${f}/users/${e}/verification`,{method:"PATCH"}),createNewUserToken:async e=>await fetch(`${f}/users/${e}/token`,{method:"POST"}),updateUserPassword:async e=>await fetch(`${f}/users/password`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),createList:async e=>await fetch(`${f}/lists`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),getList:async e=>await fetch(`${f}/lists/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),updateList:async e=>await fetch(`${f}/lists`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),deleteList:async e=>await fetch(`${f}/lists/${e}`,{method:"DELETE"}),deleteListLocation:async(e,t)=>await fetch(`${f}/lists/${e}/locations/${t}`,{method:"DELETE"}),getUserLists:async e=>await fetch(`${f}/users/${e}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getLocationLists:async(e,t)=>await fetch(`${f}/users/${e}/locations/${t}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getListLocations:async e=>await fetch(`${f}/lists/${e}/locations`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),createListLocation:async(e,t)=>await fetch(`${f}/lists/${e}/locations`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})};export{ft as a,St as b,ct as c,at as d,ut as e,q as f,ht as g,lt as h,ke as i,yt as j,_ as k,Ct as l,pt as m,wt as n,Rt as o,it as p,$ as q,mt as r,dt as s,bt as t,gt as u,Ne as v,I as w,He as x};
