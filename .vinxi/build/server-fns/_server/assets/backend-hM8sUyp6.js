import{getOwner as W,getListener as Y,onCleanup as G,sharedConfig as b,createSignal as U,startTransition as T,createMemo as Q,$TRACK as Z}from"solid-js";import{getRequestEvent as C,isServer as g}from"solid-js/web";import{b as ee,g as te,f as se,m as ne,h as re}from"./routing-BfDgGOS4.js";import{provideRequestEvent as oe}from"solid-js/web/storage";import{H3Event as L,getRequestIP as ae,setResponseStatus as ie,getResponseStatus as ce,getResponseStatusText as ue,getResponseHeader as le,setResponseHeader as de,removeResponseHeader as fe,appendResponseHeader as he,getResponseHeaders as pe,getRequestURL as ge,getRequestWebStream as ye,useSession as we,setHeader as me,parseCookies as Se,getCookie as Re,setCookie as be,getHeader as Ce,sendWebResponse as _e}from"h3";import{AsyncLocalStorage as Ae}from"node:async_hooks";function ve(e={}){let t,s=!1;const n=o=>{if(t&&t!==o)throw new Error("Context conflict")};let r;if(e.asyncContext){const o=e.AsyncLocalStorage||globalThis.AsyncLocalStorage;o?r=new o:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const a=()=>{if(r){const o=r.getStore();if(o!==void 0)return o}return t};return{use:()=>{const o=a();if(o===void 0)throw new Error("Context is not available");return o},tryUse:()=>a(),set:(o,u)=>{u||n(o),t=o,s=!0},unset:()=>{t=void 0,s=!1},call:(o,u)=>{n(o),t=o;try{return r?r.run(o,u):u()}finally{s||(t=void 0)}},async callAsync(o,u){t=o;const m=()=>{t=o},y=()=>t===o?m:void 0;j.add(y);try{const f=r?r.run(o,u):u();return s||(t=void 0),await f}finally{j.delete(y)}}}}function $e(e={}){const t={};return{get(s,n={}){return t[s]||(t[s]=ve({...e,...n})),t[s]}}}const E=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},I="__unctx__",Te=E[I]||(E[I]=$e()),Ee=(e,t={})=>Te.get(e,t),k="__unctx_async_handlers__",j=E[k]||(E[k]=new Set);function ft(e){return e}function xe(e){let t;const s=J(e),n={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(s,{...n,body:e.node.req.body}):new Request(s,{...n,get body(){return t||(t=ke(e),t)}})}function He(e){return e.web??={request:xe(e),url:J(e)},e.web.request}function Le(){return Fe()}const B=Symbol("$HTTPEvent");function Oe(e){return typeof e=="object"&&(e instanceof L||e?.[B]instanceof L||e?.__is_event__===!0)}function l(e){return function(...t){let s=t[0];if(Oe(s))t[0]=s instanceof L||s.__is_event__?s:s[B];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(s=Le(),!s)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");t.unshift(s)}return e(...t)}}const J=l(ge),Ue=l(ae),M=l(ie),N=l(ce),Pe=l(ue),$=l(pe),F=l(le),qe=l(de),K=l(he),ht=l(Se),pt=l(Re),gt=l(be),Ie=l(we),yt=l(_e),wt=l(me),mt=l(Ce),ke=l(ye),je=l(fe),Me=l(He);function Ne(){return Ee("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:Ae})}function Fe(){return Ne().use().event}const H="solidFetchEvent";function De(e){return{request:Me(e),response:Be(e),clientAddress:Ue(e),locals:{},nativeEvent:e}}function We(e){return{...e}}function St(e){if(!e.context[H]){const t=De(e);e.context[H]=t}return e.context[H]}function Rt(e,t){for(const[s,n]of t.entries())K(e,s,n)}class Ge{event;constructor(t){this.event=t}get(t){const s=F(this.event,t);return Array.isArray(s)?s.join(", "):s||null}has(t){return this.get(t)!==null}set(t,s){return qe(this.event,t,s)}delete(t){return je(this.event,t)}append(t,s){K(this.event,t,s)}getSetCookie(){const t=F(this.event,"Set-Cookie");return Array.isArray(t)?t:[t]}forEach(t){return Object.entries($(this.event)).forEach(([s,n])=>t(Array.isArray(n)?n.join(", "):n,s,this))}entries(){return Object.entries($(this.event)).map(([t,s])=>[t,Array.isArray(s)?s.join(", "):s])[Symbol.iterator]()}keys(){return Object.keys($(this.event))[Symbol.iterator]()}values(){return Object.values($(this.event)).map(t=>Array.isArray(t)?t.join(", "):t)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Be(e){return{get status(){return N(e)},set status(t){M(e,t)},get statusText(){return Pe(e)},set statusText(t){M(e,N(e),t)},headers:new Ge(e)}}function x(e,t,s){if(typeof e!="function")throw new Error("Export from a 'use server' module must be a function");const n="";return new Proxy(e,{get(r,a,o){return a==="url"?`${n}/_server?id=${encodeURIComponent(t)}&name=${encodeURIComponent(s)}`:a==="GET"?o:r[a]},apply(r,a,o){const u=C();if(!u)throw new Error("Cannot call server function outside of a request");const m=We(u);return m.locals.serverFunctionMeta={id:t+"#"+s},m.serverOnly=!0,oe(m,()=>e.apply(a,o))}})}const Je="Location",Ke=5e3,Xe=18e4;let A=new Map;g||setInterval(()=>{const e=Date.now();for(let[t,s]of A.entries())!s[4].count&&e-s[0]>Xe&&A.delete(t)},3e5);function v(){if(!g)return A;const e=C();if(!e)throw new Error("Cannot find cache context");return(e.router||(e.router={})).cache||(e.router.cache=new Map)}function ze(e,t=!0){return T(()=>{const s=Date.now();X(e,n=>{t&&(n[0]=0),n[4][1](s)})})}function X(e,t){e&&!Array.isArray(e)&&(e=[e]);for(let s of A.keys())(e===void 0||z(s,e))&&t(A.get(s))}function _(e,t){e.GET&&(e=e.GET);const s=(...n)=>{const r=v(),a=te(),o=se(),m=W()?ee():void 0,y=Date.now(),f=t+O(n);let i=r.get(f),R;if(g){const c=C();if(c){const h=(c.router||(c.router={})).dataOnly;if(h){const S=c&&(c.router.data||(c.router.data={}));if(S&&f in S)return S[f];if(Array.isArray(h)&&!z(f,h))return S[f]=void 0,Promise.resolve()}}}if(Y()&&!g&&(R=!0,G(()=>i[4].count--)),i&&i[0]&&(g||a==="native"||i[4].count||Date.now()-i[0]<Ke)){R&&(i[4].count++,i[4][0]()),i[3]==="preload"&&a!=="preload"&&(i[0]=y);let c=i[1];return a!=="preload"&&(c="then"in i[1]?i[1].then(w(!1),w(!0)):w(!1)(i[1]),!g&&a==="navigate"&&T(()=>i[4][1](i[0]))),o&&"then"in c&&c.catch(()=>{}),c}let d;if(!g&&b.has&&b.has(f)?(d=b.load(f),delete globalThis._$HY.r[f]):d=e(...n),i?(i[0]=y,i[1]=d,i[3]=a,!g&&a==="navigate"&&T(()=>i[4][1](i[0]))):(r.set(f,i=[y,d,,a,U(y)]),i[4].count=0),R&&(i[4].count++,i[4][0]()),g){const c=C();if(c&&c.router.dataOnly)return c.router.data[f]=d}if(a!=="preload"&&(d="then"in d?d.then(w(!1),w(!0)):w(!1)(d)),o&&"then"in d&&d.catch(()=>{}),g&&b.context&&b.context.async&&!b.context.noHydrate){const c=C();(!c||!c.serverOnly)&&b.context.serialize(f,d)}return d;function w(c){return async h=>{if(h instanceof Response){const S=h.headers.get(Je);if(S!==null){if(m&&S.startsWith("/"))T(()=>{m(S,{replace:!0})});else if(!g)window.location.href=S;else if(g){const q=C();q&&(q.response={status:302,headers:new Headers({Location:S})})}return}h.customBody&&(h=await h.customBody())}if(c)throw h;return i[2]=h,h}}};return s.keyFor=(...n)=>t+O(n),s.key=t,s}_.get=e=>v().get(e)[2];_.set=(e,t)=>{const s=v(),n=Date.now();let r=s.get(e);r?(r[0]=n,r[1]=Promise.resolve(t),r[2]=t,r[3]="preload"):(s.set(e,r=[n,Promise.resolve(t),t,"preload",U(n)]),r[4].count=0)};_.delete=e=>v().delete(e);_.clear=()=>v().clear();function z(e,t){for(let s of t)if(s&&e.startsWith(s))return!0;return!1}function O(e){return JSON.stringify(e,(t,s)=>Ve(s)?Object.keys(s).sort().reduce((n,r)=>(n[r]=s[r],n),{}):s)}function Ve(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}const D=new Map;function Ye(e,t){const s=re(),n=Q(()=>s.submissions[0]().filter(r=>r.url===e.base&&!0));return new Proxy([],{get(r,a){return a===Z?n():a==="pending"?n().some(o=>!o.result):n()[a]},has(r,a){return a in n()}})}function bt(e,t){const s=Ye(e);return new Proxy({},{get(n,r){return s.length===0&&r==="clear"||r==="retry"?()=>{}:s[s.length-1]?.[r]}})}function Ct(e,t={}){function s(...a){const o=this.r,u=this.f,m=(o.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...a),[y,f]=U();let i;function R(d){return async w=>{const c=await Ze(w,d,o.navigatorFactory());let h=null;if(n.onComplete?.({...i,result:c?.data,error:c?.error,pending:!1,retry(){return h=i.retry()}}),h)return h;if(!c)return i.clear();if(f(c),c.error&&!u)throw c.error;return c.data}}return o.submissions[1](d=>[...d,i={input:a,url:r,get result(){return y()?.data},get error(){return y()?.error},get pending(){return!y()},clear(){o.submissions[1](w=>w.filter(c=>c!==i))},retry(){return f(void 0),e(...a).then(R(),R(!0))}}]),m.then(R(),R(!0))}const n=typeof t=="string"?{name:t}:t,r=e.url||n.name&&`https://action/${n.name}`||(g?"":`https://action/${Qe(e.toString())}`);return s.base=r,V(s,r)}function V(e,t){return e.toString=()=>{if(!t)throw new Error("Client Actions need explicit names if server rendered");return t},e.with=function(...s){const n=function(...a){return e.call(this,...s,...a)};n.base=e.base;const r=new URL(t,ne);return r.searchParams.set("args",O(s)),V(n,(r.origin==="https://action"?r.origin:"")+r.pathname+r.search)},e.url=t,g||(D.set(t,e),W()&&G(()=>D.delete(t))),e}const Qe=e=>e.split("").reduce((t,s)=>(t<<5)-t+s.charCodeAt(0)|0,0);async function Ze(e,t,s){let n,r,a,o;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(a=e.headers.get("X-Revalidate").split(",")),e.customBody&&(n=r=await e.customBody(),e.headers.has("X-Single-Flight")&&(n=n._$value,delete r._$value,o=Object.keys(r))),e.headers.has("Location")){const u=e.headers.get("Location")||"/";u.startsWith("http")?window.location.href=u:s(u)}}else{if(t)return{error:e};n=e}return X(a,u=>u[0]=0),o&&o.forEach(u=>_.set(u,r[u])),await ze(a,!1),n!=null?{data:n}:void 0}function _t(e,t=302){let s,n;typeof t=="number"?s={status:t}:({revalidate:n,...s}=t,typeof s.status>"u"&&(s.status=302));const r=new Headers(s.headers);return r.set("Location",e),n!==void 0&&r.set("X-Revalidate",n.toString()),new Response(null,{...s,headers:r})}function At(e,t={}){const{revalidate:s,...n}=t,r=new Headers(n.headers);s!==void 0&&r.set("X-Revalidate",s.toString()),r.set("Content-Type","application/json");const a=new Response(JSON.stringify(e),{...n,headers:r});return a.customBody=()=>e,a}const et="900da1c8f697beefdab33bc8ff480a1448f58fd015ec3108dc3b323bdaa0c245",tt=3600*24,st=x(function(){return Ie({name:"oaq_explorer_session",password:et,maxAge:tt})},"src_auth_session_ts--getSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),P=st,nt=x(async()=>{const{data:e}=await P();return e.usersId?e:null},"src_auth_session_ts--getSessionUser_query","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),vt=_(nt,"session-user"),rt=x(async function(t,s){const n=await P();await n.update(r=>(r.usersId=t,r)),await n.update(r=>{r.maxAge=s})},"src_auth_session_ts--setSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),$t=rt,ot=x(async function(){await(await P()).update(s=>s.usersId=void 0)},"src_auth_session_ts--clearSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),Tt=ot,p=process.env.REST_API_URL||"http://localhost:8080",Et={createUser:async e=>await fetch(`${p}/users`,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}),getUserById:async e=>await fetch(`${p}/users/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByEmailAddress:async e=>await fetch(`${p}/users/email/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByVerificationCode:async e=>await fetch(`${p}/users/verification-code/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),verifyUser:async e=>await fetch(`${p}/users/${e}/verification`,{method:"PATCH"}),createNewUserToken:async e=>await fetch(`${p}/users/${e}/token`,{method:"POST"}),updateUserPassword:async e=>await fetch(`${p}/users/password`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),createList:async e=>await fetch(`${p}/lists`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),getList:async e=>await fetch(`${p}/lists/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),updateList:async e=>await fetch(`${p}/lists`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),deleteList:async e=>await fetch(`${p}/lists/${e}`,{method:"DELETE"}),deleteListLocation:async(e,t)=>await fetch(`${p}/lists/${e}/locations/${t}`,{method:"DELETE"}),getUserLists:async e=>await fetch(`${p}/users/${e}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getLocationLists:async(e,t)=>await fetch(`${p}/users/${e}/locations/${t}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getListLocations:async e=>await fetch(`${p}/lists/${e}/locations`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),createListLocation:async(e,t)=>await fetch(`${p}/lists/${e}/locations`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})};export{mt as a,vt as b,pt as c,ft as d,gt as e,M as f,St as g,wt as h,We as i,Ct as j,x as k,Et as l,Rt as m,At as n,$t as o,ht as p,_ as q,_t as r,yt as s,Tt as t,bt as u,ze as v,D as w,Ie as x};
