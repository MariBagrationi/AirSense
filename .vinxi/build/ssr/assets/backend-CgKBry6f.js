import{getOwner as W,getListener as V,onCleanup as G,sharedConfig as b,createSignal as U,startTransition as T,createMemo as Y,$TRACK as Q}from"solid-js";import{getRequestEvent as C,isServer as g}from"solid-js/web";import{j as Z,g as ee,r as te,m as se,t as ne}from"./routing-BPjDSAJ2.js";import{provideRequestEvent as re}from"solid-js/web/storage";import{H3Event as L,getRequestIP as oe,setResponseStatus as ae,getResponseStatus as ie,getResponseStatusText as ce,getResponseHeader as ue,setResponseHeader as de,removeResponseHeader as le,appendResponseHeader as fe,getResponseHeaders as he,getRequestURL as pe,getRequestWebStream as ge,useSession as ye,sendRedirect as we,setHeader as me,getHeader as Se,sendWebResponse as Re,getCookie as be,setCookie as Ce}from"h3";import{AsyncLocalStorage as _e}from"node:async_hooks";function Ae(e={}){let t,s=!1;const r=o=>{if(t&&t!==o)throw new Error("Context conflict")};let n;if(e.asyncContext){const o=e.AsyncLocalStorage||globalThis.AsyncLocalStorage;o?n=new o:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const a=()=>{if(n){const o=n.getStore();if(o!==void 0)return o}return t};return{use:()=>{const o=a();if(o===void 0)throw new Error("Context is not available");return o},tryUse:()=>a(),set:(o,u)=>{u||r(o),t=o,s=!0},unset:()=>{t=void 0,s=!1},call:(o,u)=>{r(o),t=o;try{return n?n.run(o,u):u()}finally{s||(t=void 0)}},async callAsync(o,u){t=o;const m=()=>{t=o},y=()=>t===o?m:void 0;k.add(y);try{const f=n?n.run(o,u):u();return s||(t=void 0),await f}finally{k.delete(y)}}}}function $e(e={}){const t={};return{get(s,r={}){return t[s]||(t[s]=Ae({...e,...r})),t[s]}}}const E=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},I="__unctx__",ve=E[I]||(E[I]=$e()),Te=(e,t={})=>ve.get(e,t),j="__unctx_async_handlers__",k=E[j]||(E[j]=new Set);function ft(e){return e}function Ee(e){let t;const s=J(e),r={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(s,{...r,body:e.node.req.body}):new Request(s,{...r,get body(){return t||(t=je(e),t)}})}function xe(e){return e.web??={request:Ee(e),url:J(e)},e.web.request}function He(){return Fe()}const B=Symbol("$HTTPEvent");function Le(e){return typeof e=="object"&&(e instanceof L||e?.[B]instanceof L||e?.__is_event__===!0)}function d(e){return function(...t){let s=t[0];if(Le(s))t[0]=s instanceof L||s.__is_event__?s:s[B];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(s=He(),!s)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");t.unshift(s)}return e(...t)}}const J=d(pe),Oe=d(oe),M=d(ae),N=d(ie),Ue=d(ce),v=d(he),F=d(ue),Pe=d(de),qe=d(fe),ht=d(we),pt=d(be),gt=d(Ce),Ie=d(ye),yt=d(Re),wt=d(me),mt=d(Se),je=d(ge),ke=d(le),Me=d(xe);function Ne(){return Te("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:_e})}function Fe(){return Ne().use().event}const H="solidFetchEvent";function De(e){return{request:Me(e),response:Be(e),clientAddress:Oe(e),locals:{},nativeEvent:e}}function We(e){return{...e}}function St(e){if(!e.context[H]){const t=De(e);e.context[H]=t}return e.context[H]}class Ge{event;constructor(t){this.event=t}get(t){const s=F(this.event,t);return Array.isArray(s)?s.join(", "):s||null}has(t){return this.get(t)!==null}set(t,s){return Pe(this.event,t,s)}delete(t){return ke(this.event,t)}append(t,s){qe(this.event,t,s)}getSetCookie(){const t=F(this.event,"Set-Cookie");return Array.isArray(t)?t:[t]}forEach(t){return Object.entries(v(this.event)).forEach(([s,r])=>t(Array.isArray(r)?r.join(", "):r,s,this))}entries(){return Object.entries(v(this.event)).map(([t,s])=>[t,Array.isArray(s)?s.join(", "):s])[Symbol.iterator]()}keys(){return Object.keys(v(this.event))[Symbol.iterator]()}values(){return Object.values(v(this.event)).map(t=>Array.isArray(t)?t.join(", "):t)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Be(e){return{get status(){return N(e)},set status(t){M(e,t)},get statusText(){return Ue(e)},set statusText(t){M(e,N(e),t)},headers:new Ge(e)}}function x(e,t,s){if(typeof e!="function")throw new Error("Export from a 'use server' module must be a function");const r="";return new Proxy(e,{get(n,a,o){return a==="url"?`${r}/_server?id=${encodeURIComponent(t)}&name=${encodeURIComponent(s)}`:a==="GET"?o:n[a]},apply(n,a,o){const u=C();if(!u)throw new Error("Cannot call server function outside of a request");const m=We(u);return m.locals.serverFunctionMeta={id:t+"#"+s},m.serverOnly=!0,re(m,()=>e.apply(a,o))}})}const Je="Location",Ke=5e3,Xe=18e4;let A=new Map;g||setInterval(()=>{const e=Date.now();for(let[t,s]of A.entries())!s[4].count&&e-s[0]>Xe&&A.delete(t)},3e5);function $(){if(!g)return A;const e=C();if(!e)throw new Error("Cannot find cache context");return(e.router||(e.router={})).cache||(e.router.cache=new Map)}function ze(e,t=!0){return T(()=>{const s=Date.now();K(e,r=>{t&&(r[0]=0),r[4][1](s)})})}function K(e,t){e&&!Array.isArray(e)&&(e=[e]);for(let s of A.keys())(e===void 0||X(s,e))&&t(A.get(s))}function _(e,t){e.GET&&(e=e.GET);const s=(...r)=>{const n=$(),a=ee(),o=te(),m=W()?Z():void 0,y=Date.now(),f=t+O(r);let i=n.get(f),R;if(g){const c=C();if(c){const h=(c.router||(c.router={})).dataOnly;if(h){const S=c&&(c.router.data||(c.router.data={}));if(S&&f in S)return S[f];if(Array.isArray(h)&&!X(f,h))return S[f]=void 0,Promise.resolve()}}}if(V()&&!g&&(R=!0,G(()=>i[4].count--)),i&&i[0]&&(g||a==="native"||i[4].count||Date.now()-i[0]<Ke)){R&&(i[4].count++,i[4][0]()),i[3]==="preload"&&a!=="preload"&&(i[0]=y);let c=i[1];return a!=="preload"&&(c="then"in i[1]?i[1].then(w(!1),w(!0)):w(!1)(i[1]),!g&&a==="navigate"&&T(()=>i[4][1](i[0]))),o&&"then"in c&&c.catch(()=>{}),c}let l;if(!g&&b.has&&b.has(f)?(l=b.load(f),delete globalThis._$HY.r[f]):l=e(...r),i?(i[0]=y,i[1]=l,i[3]=a,!g&&a==="navigate"&&T(()=>i[4][1](i[0]))):(n.set(f,i=[y,l,,a,U(y)]),i[4].count=0),R&&(i[4].count++,i[4][0]()),g){const c=C();if(c&&c.router.dataOnly)return c.router.data[f]=l}if(a!=="preload"&&(l="then"in l?l.then(w(!1),w(!0)):w(!1)(l)),o&&"then"in l&&l.catch(()=>{}),g&&b.context&&b.context.async&&!b.context.noHydrate){const c=C();(!c||!c.serverOnly)&&b.context.serialize(f,l)}return l;function w(c){return async h=>{if(h instanceof Response){const S=h.headers.get(Je);if(S!==null){if(m&&S.startsWith("/"))T(()=>{m(S,{replace:!0})});else if(!g)window.location.href=S;else if(g){const q=C();q&&(q.response={status:302,headers:new Headers({Location:S})})}return}h.customBody&&(h=await h.customBody())}if(c)throw h;return i[2]=h,h}}};return s.keyFor=(...r)=>t+O(r),s.key=t,s}_.get=e=>$().get(e)[2];_.set=(e,t)=>{const s=$(),r=Date.now();let n=s.get(e);n?(n[0]=r,n[1]=Promise.resolve(t),n[2]=t,n[3]="preload"):(s.set(e,n=[r,Promise.resolve(t),t,"preload",U(r)]),n[4].count=0)};_.delete=e=>$().delete(e);_.clear=()=>$().clear();function X(e,t){for(let s of t)if(s&&e.startsWith(s))return!0;return!1}function O(e){return JSON.stringify(e,(t,s)=>Ve(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function Ve(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}const D=new Map;function Ye(e,t){const s=ne(),r=Y(()=>s.submissions[0]().filter(n=>n.url===e.base&&!0));return new Proxy([],{get(n,a){return a===Q?r():a==="pending"?r().some(o=>!o.result):r()[a]},has(n,a){return a in r()}})}function Rt(e,t){const s=Ye(e);return new Proxy({},{get(r,n){return s.length===0&&n==="clear"||n==="retry"?()=>{}:s[s.length-1]?.[n]}})}function bt(e,t={}){function s(...a){const o=this.r,u=this.f,m=(o.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...a),[y,f]=U();let i;function R(l){return async w=>{const c=await Ze(w,l,o.navigatorFactory());let h=null;if(r.onComplete?.({...i,result:c?.data,error:c?.error,pending:!1,retry(){return h=i.retry()}}),h)return h;if(!c)return i.clear();if(f(c),c.error&&!u)throw c.error;return c.data}}return o.submissions[1](l=>[...l,i={input:a,url:n,get result(){return y()?.data},get error(){return y()?.error},get pending(){return!y()},clear(){o.submissions[1](w=>w.filter(c=>c!==i))},retry(){return f(void 0),e(...a).then(R(),R(!0))}}]),m.then(R(),R(!0))}const r=typeof t=="string"?{name:t}:t,n=e.url||r.name&&`https://action/${r.name}`||(g?"":`https://action/${Qe(e.toString())}`);return s.base=n,z(s,n)}function z(e,t){return e.toString=()=>{if(!t)throw new Error("Client Actions need explicit names if server rendered");return t},e.with=function(...s){const r=function(...a){return e.call(this,...s,...a)};r.base=e.base;const n=new URL(t,se);return n.searchParams.set("args",O(s)),z(r,(n.origin==="https://action"?n.origin:"")+n.pathname+n.search)},e.url=t,g||(D.set(t,e),W()&&G(()=>D.delete(t))),e}const Qe=e=>e.split("").reduce((t,s)=>(t<<5)-t+s.charCodeAt(0)|0,0);async function Ze(e,t,s){let r,n,a,o;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(a=e.headers.get("X-Revalidate").split(",")),e.customBody&&(r=n=await e.customBody(),e.headers.has("X-Single-Flight")&&(r=r._$value,delete n._$value,o=Object.keys(n))),e.headers.has("Location")){const u=e.headers.get("Location")||"/";u.startsWith("http")?window.location.href=u:s(u)}}else{if(t)return{error:e};r=e}return K(a,u=>u[0]=0),o&&o.forEach(u=>_.set(u,n[u])),await ze(a,!1),r!=null?{data:r}:void 0}function Ct(e,t=302){let s,r;typeof t=="number"?s={status:t}:({revalidate:r,...s}=t,typeof s.status>"u"&&(s.status=302));const n=new Headers(s.headers);return n.set("Location",e),r!==void 0&&n.set("X-Revalidate",r.toString()),new Response(null,{...s,headers:n})}function _t(e,t={}){const{revalidate:s,...r}=t,n=new Headers(r.headers);s!==void 0&&n.set("X-Revalidate",s.toString()),n.set("Content-Type","application/json");const a=new Response(JSON.stringify(e),{...r,headers:n});return a.customBody=()=>e,a}const et="900da1c8f697beefdab33bc8ff480a1448f58fd015ec3108dc3b323bdaa0c245",tt=3600*24,st=x(function(){return Ie({name:"oaq_explorer_session",password:et,maxAge:tt})},"src_auth_session_ts--getSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),P=st,nt=x(async()=>{const{data:e}=await P();return e.usersId?e:null},"src_auth_session_ts--getSessionUser_query","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),At=_(nt,"session-user"),rt=x(async function(t,s){const r=await P();await r.update(n=>(n.usersId=t,n)),await r.update(n=>{n.maxAge=s})},"src_auth_session_ts--setSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),$t=rt,ot=x(async function(){await(await P()).update(s=>s.usersId=void 0)},"src_auth_session_ts--clearSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),vt=ot,p=process.env.REST_API_URL||"http://localhost:8080",Tt={createUser:async e=>await fetch(`${p}/users`,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}),getUserById:async e=>await fetch(`${p}/users/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByEmailAddress:async e=>await fetch(`${p}/users/email/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByVerificationCode:async e=>await fetch(`${p}/users/verification-code/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),verifyUser:async e=>await fetch(`${p}/users/${e}/verification`,{method:"PATCH"}),createNewUserToken:async e=>await fetch(`${p}/users/${e}/token`,{method:"POST"}),updateUserPassword:async e=>await fetch(`${p}/users/password`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),createList:async e=>await fetch(`${p}/lists`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),getList:async e=>await fetch(`${p}/lists/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),updateList:async e=>await fetch(`${p}/lists`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),deleteList:async e=>await fetch(`${p}/lists/${e}`,{method:"DELETE"}),deleteListLocation:async(e,t)=>await fetch(`${p}/lists/${e}/locations/${t}`,{method:"DELETE"}),getUserLists:async e=>await fetch(`${p}/users/${e}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getLocationLists:async(e,t)=>await fetch(`${p}/users/${e}/locations/${t}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getListLocations:async e=>await fetch(`${p}/lists/${e}/locations`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),createListLocation:async(e,t)=>await fetch(`${p}/lists/${e}/locations`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})};export{mt as a,D as b,At as c,ft as d,pt as e,gt as f,St as g,ht as h,M as i,wt as j,bt as k,x as l,Tt as m,_t as n,$t as o,vt as p,_ as q,Ct as r,yt as s,ze as t,Rt as u};
