import{createUniqueId as f,createEffect as r,onCleanup as u}from"solid-js";import{u as y,a as x,l as h}from"./maplibre-gl-Ukol7sIV.js";import{ssrElement as b,mergeProps as g,ssr as v}from"solid-js/web";const L=["id","type","filter","source","source-layer","minzoom","metadata","maxzoom","paint","layout"],w=["visibility","line-join","line-cap","line-miter-limit","line-round-limit","line-sort-key","circle-sort-key","symbol-avoid-edges","symbol-placement","symbol-sort-key","symbol-spacing","symbol-z-order","icon-allow-overlap","icon-anchor","icon-ignore-placement","icon-image","icon-keep-upright","icon-offset","icon-optional","icon-padding","icon-pitch-alignment","icon-rotate","icon-rotation-alignment","icon-size","icon-text-fit","icon-text-fit-padding","text-allow-overlap","text-anchor","text-field","text-font","text-ignore-placement","text-justify","text-keep-upright","text-letter-spacing","text-line-height","text-max-angle","text-max-width","text-offset","text-optional","text-padding","text-pitch-alignment","text-radial-offset","text-rotate","text-rotation-alignment","text-size","text-transform","text-variable-anchor","text-writing-mode"],d=(e={},t={})=>[...new Set([...Object.keys(e),...Object.keys(t)])].reduce((n,i)=>{const a=e[i];return a!==t[i]&&n.push([i,a]),n},[]),m=(e,t)=>(e.startsWith(t)||e.startsWith("icon")||e.startsWith("text")?"":t+"-")+e.replace(/[A-Z]/g,l=>"-"+l.toLowerCase()),s=e=>{if(!e)return;let t={},l={},n={};return Object.entries(e).forEach(([i,a])=>{if(L.includes(i))n[i]=a;else{const o=m(i,e.type);w.includes(o)?t[o]=a:l[o]=a}}),e.paint&&Object.entries(e.paint).forEach(([i,a])=>l[m(i,e.type)]=a),e.layout&&Object.entries(e.layout).forEach(([i,a])=>t[m(i,e.type)]=a),{...n,paint:l,layout:t}},j=e=>{const[t]=y(),l=e.style?.source||x();e.id=e.id||e.customLayer?.id||f();const n=(i,a)=>{t.map.debug&&console.debug("%c[MapGL]","color: #10b981",i,a||"")};return t.map.addLayer(e.customLayer||{...s(e.style),id:e.id,source:l,metadata:{smg:{beforeType:e.beforeType,beforeId:e.beforeId}}},e.beforeType?t.map.getStyle().layers.find(i=>i.type===e.beforeType)?.id:e.beforeId),t.map.layerIdList.push(e.id),e.customLayer&&t.map.fire("load"),n("Add Layer:",e.id),h.forEach(i=>{if(e[i]){const a=i.slice(2).toLowerCase();t.map.on(a,e.id,o=>{o.clickOnLayer=!0,e[i](o),n(`Layer '${a}' event on '${e.id}':`,o)})}}),r(i=>{const a=s(e.style);if(a!==i)return a.layout!==i?.layout&&d(a.layout,i?.layout).forEach(([o,c])=>t.map.setLayoutProperty(e.id,o,c,{validate:!1})),a.paint!==i?.paint&&d(a.paint,i?.paint).forEach(([o,c])=>t.map.setPaintProperty(e.id,o,c,{validate:!1})),(a.minzoom!==i?.minzoom||a.maxzoom!==i?.maxzoom)&&t.map.setLayerZoomRange(e.id,a.minzoom,a.maxzoom),a.filter!==i?.filter&&t.map.setFilter(e.id,a.filter,{validate:!1}),n("Update Layer Style:",e.id),a},s(e.style)),r(i=>{if(e.visible!==i)return t.map.setLayoutProperty(e.id,"visibility",e.visible?"visible":"none",{validate:!1}),n(`Update Visibility (${e.id}):`,e.visible.toString()),e.visible},e.visible),r(async()=>{e.filter&&(!t.map.isStyleLoaded()&&await t.map.once("styledata"),t.map.setFilter(e.id,e.filter),n(`Update Filter (${e.id}):`,e.filter))}),r(async()=>{!e.featureState||e.featureState.id===null||(!t.map.isStyleLoaded()&&await t.map.once("styledata"),t.map.removeFeatureState({source:l,sourceLayer:e.style["source-layer"]}),t.map.setFeatureState({source:l,sourceLayer:e.style["source-layer"],id:e.featureState.id},e.featureState.state))}),u(()=>t.map?.getLayer(e.id)&&t.map?.removeLayer(e.id)),e.children};var z='<path d="m376-300 104-104 104 104 56-56-104-104 104-104-56-56-104 104-104-104-56 56 104 104-104 104zm-96 180q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120zm400-600H280v520h400zm-400 0v520z"></path>';const F=(e={})=>b("svg",g({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>v(z),!0);export{F as D,j as L};
