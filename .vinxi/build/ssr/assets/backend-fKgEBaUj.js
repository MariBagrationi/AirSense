import{getOwner as M,getListener as J,onCleanup as F,sharedConfig as b,createSignal as L,startTransition as v,createMemo as X,$TRACK as K}from"solid-js";import{getRequestEvent as $,isServer as g}from"solid-js/web";import{j as z,g as V,r as Y,m as Q,t as Z}from"./routing-BPjDSAJ2.js";import{provideRequestEvent as ee}from"solid-js/web/storage";import{H3Event as x,getRequestIP as te,setResponseStatus as se,getResponseStatus as ne,getResponseStatusText as re,getResponseHeader as oe,setResponseHeader as ae,removeResponseHeader as ie,appendResponseHeader as ce,getResponseHeaders as ue,getRequestURL as de,getRequestWebStream as le,useSession as fe,sendRedirect as he,setHeader as pe,getHeader as ge,sendWebResponse as ye,getCookie as me,setCookie as we}from"h3";import{getContext as Se}from"unctx";import{AsyncLocalStorage as Re}from"node:async_hooks";function at(e){return e}function be(e){let t;const s=N(e),n={duplex:"half",method:e.method,headers:e.headers};return e.node.req.body instanceof ArrayBuffer?new Request(s,{...n,body:e.node.req.body}):new Request(s,{...n,get body(){return t||(t=xe(e),t)}})}function $e(e){return e.web??={request:be(e),url:N(e)},e.web.request}function Ce(){return Pe()}const D=Symbol("$HTTPEvent");function Ae(e){return typeof e=="object"&&(e instanceof x||e?.[D]instanceof x||e?.__is_event__===!0)}function c(e){return function(...t){let s=t[0];if(Ae(s))t[0]=s instanceof x||s.__is_event__?s:s[D];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(s=Ce(),!s)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");t.unshift(s)}return e(...t)}}const N=c(de),Ee=c(te),q=c(se),j=c(ne),Te=c(re),T=c(ue),k=c(oe),ve=c(ae),_e=c(ce),it=c(he),ct=c(me),ut=c(we),He=c(fe),dt=c(ye),lt=c(pe),ft=c(ge),xe=c(le),Oe=c(ie),Le=c($e);function Ue(){return Se("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:Re})}function Pe(){return Ue().use().event}const H="solidFetchEvent";function qe(e){return{request:Le(e),response:Ie(e),clientAddress:Ee(e),locals:{},nativeEvent:e}}function je(e){return{...e}}function ht(e){if(!e.context[H]){const t=qe(e);e.context[H]=t}return e.context[H]}class ke{event;constructor(t){this.event=t}get(t){const s=k(this.event,t);return Array.isArray(s)?s.join(", "):s||null}has(t){return this.get(t)!==null}set(t,s){return ve(this.event,t,s)}delete(t){return Oe(this.event,t)}append(t,s){_e(this.event,t,s)}getSetCookie(){const t=k(this.event,"Set-Cookie");return Array.isArray(t)?t:[t]}forEach(t){return Object.entries(T(this.event)).forEach(([s,n])=>t(Array.isArray(n)?n.join(", "):n,s,this))}entries(){return Object.entries(T(this.event)).map(([t,s])=>[t,Array.isArray(s)?s.join(", "):s])[Symbol.iterator]()}keys(){return Object.keys(T(this.event))[Symbol.iterator]()}values(){return Object.values(T(this.event)).map(t=>Array.isArray(t)?t.join(", "):t)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Ie(e){return{get status(){return j(e)},set status(t){q(e,t)},get statusText(){return Te(e)},set statusText(t){q(e,j(e),t)},headers:new ke(e)}}function _(e,t,s){if(typeof e!="function")throw new Error("Export from a 'use server' module must be a function");const n="";return new Proxy(e,{get(r,o,u){return o==="url"?`${n}/_server?id=${encodeURIComponent(t)}&name=${encodeURIComponent(s)}`:o==="GET"?u:r[o]},apply(r,o,u){const h=$();if(!h)throw new Error("Cannot call server function outside of a request");const w=je(h);return w.locals.serverFunctionMeta={id:t+"#"+s},w.serverOnly=!0,ee(w,()=>e.apply(o,u))}})}const Me="Location",Fe=5e3,De=18e4;let A=new Map;g||setInterval(()=>{const e=Date.now();for(let[t,s]of A.entries())!s[4].count&&e-s[0]>De&&A.delete(t)},3e5);function E(){if(!g)return A;const e=$();if(!e)throw new Error("Cannot find cache context");return(e.router||(e.router={})).cache||(e.router.cache=new Map)}function Ne(e,t=!0){return v(()=>{const s=Date.now();W(e,n=>{t&&(n[0]=0),n[4][1](s)})})}function W(e,t){e&&!Array.isArray(e)&&(e=[e]);for(let s of A.keys())(e===void 0||G(s,e))&&t(A.get(s))}function C(e,t){e.GET&&(e=e.GET);const s=(...n)=>{const r=E(),o=V(),u=Y(),w=M()?z():void 0,S=Date.now(),p=t+O(n);let a=r.get(p),R;if(g){const i=$();if(i){const l=(i.router||(i.router={})).dataOnly;if(l){const m=i&&(i.router.data||(i.router.data={}));if(m&&p in m)return m[p];if(Array.isArray(l)&&!G(p,l))return m[p]=void 0,Promise.resolve()}}}if(J()&&!g&&(R=!0,F(()=>a[4].count--)),a&&a[0]&&(g||o==="native"||a[4].count||Date.now()-a[0]<Fe)){R&&(a[4].count++,a[4][0]()),a[3]==="preload"&&o!=="preload"&&(a[0]=S);let i=a[1];return o!=="preload"&&(i="then"in a[1]?a[1].then(y(!1),y(!0)):y(!1)(a[1]),!g&&o==="navigate"&&v(()=>a[4][1](a[0]))),u&&"then"in i&&i.catch(()=>{}),i}let d;if(!g&&b.has&&b.has(p)?(d=b.load(p),delete globalThis._$HY.r[p]):d=e(...n),a?(a[0]=S,a[1]=d,a[3]=o,!g&&o==="navigate"&&v(()=>a[4][1](a[0]))):(r.set(p,a=[S,d,,o,L(S)]),a[4].count=0),R&&(a[4].count++,a[4][0]()),g){const i=$();if(i&&i.router.dataOnly)return i.router.data[p]=d}if(o!=="preload"&&(d="then"in d?d.then(y(!1),y(!0)):y(!1)(d)),u&&"then"in d&&d.catch(()=>{}),g&&b.context&&b.context.async&&!b.context.noHydrate){const i=$();(!i||!i.serverOnly)&&b.context.serialize(p,d)}return d;function y(i){return async l=>{if(l instanceof Response){const m=l.headers.get(Me);if(m!==null){if(w&&m.startsWith("/"))v(()=>{w(m,{replace:!0})});else if(!g)window.location.href=m;else if(g){const P=$();P&&(P.response={status:302,headers:new Headers({Location:m})})}return}l.customBody&&(l=await l.customBody())}if(i)throw l;return a[2]=l,l}}};return s.keyFor=(...n)=>t+O(n),s.key=t,s}C.get=e=>E().get(e)[2];C.set=(e,t)=>{const s=E(),n=Date.now();let r=s.get(e);r?(r[0]=n,r[1]=Promise.resolve(t),r[2]=t,r[3]="preload"):(s.set(e,r=[n,Promise.resolve(t),t,"preload",L(n)]),r[4].count=0)};C.delete=e=>E().delete(e);C.clear=()=>E().clear();function G(e,t){for(let s of t)if(s&&e.startsWith(s))return!0;return!1}function O(e){return JSON.stringify(e,(t,s)=>We(s)?Object.keys(s).sort().reduce((n,r)=>(n[r]=s[r],n),{}):s)}function We(e){let t;return e!=null&&typeof e=="object"&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype)}const I=new Map;function Ge(e,t){const s=Z(),n=X(()=>s.submissions[0]().filter(r=>r.url===e.base&&!0));return new Proxy([],{get(r,o){return o===K?n():o==="pending"?n().some(u=>!u.result):n()[o]},has(r,o){return o in n()}})}function pt(e,t){const s=Ge(e);return new Proxy({},{get(n,r){return s.length===0&&r==="clear"||r==="retry"?()=>{}:s[s.length-1]?.[r]}})}function gt(e,t={}){function s(...o){const u=this.r,h=this.f,w=(u.singleFlight&&e.withOptions?e.withOptions({headers:{"X-Single-Flight":"true"}}):e)(...o),[S,p]=L();let a;function R(d){return async y=>{const i=await Je(y,d,u.navigatorFactory());let l=null;if(n.onComplete?.({...a,result:i?.data,error:i?.error,pending:!1,retry(){return l=a.retry()}}),l)return l;if(!i)return a.clear();if(p(i),i.error&&!h)throw i.error;return i.data}}return u.submissions[1](d=>[...d,a={input:o,url:r,get result(){return S()?.data},get error(){return S()?.error},get pending(){return!S()},clear(){u.submissions[1](y=>y.filter(i=>i!==a))},retry(){return p(void 0),e(...o).then(R(),R(!0))}}]),w.then(R(),R(!0))}const n=typeof t=="string"?{name:t}:t,r=e.url||n.name&&`https://action/${n.name}`||(g?"":`https://action/${Be(e.toString())}`);return s.base=r,B(s,r)}function B(e,t){return e.toString=()=>{if(!t)throw new Error("Client Actions need explicit names if server rendered");return t},e.with=function(...s){const n=function(...o){return e.call(this,...s,...o)};n.base=e.base;const r=new URL(t,Q);return r.searchParams.set("args",O(s)),B(n,(r.origin==="https://action"?r.origin:"")+r.pathname+r.search)},e.url=t,g||(I.set(t,e),M()&&F(()=>I.delete(t))),e}const Be=e=>e.split("").reduce((t,s)=>(t<<5)-t+s.charCodeAt(0)|0,0);async function Je(e,t,s){let n,r,o,u;if(e instanceof Response){if(e.headers.has("X-Revalidate")&&(o=e.headers.get("X-Revalidate").split(",")),e.customBody&&(n=r=await e.customBody(),e.headers.has("X-Single-Flight")&&(n=n._$value,delete r._$value,u=Object.keys(r))),e.headers.has("Location")){const h=e.headers.get("Location")||"/";h.startsWith("http")?window.location.href=h:s(h)}}else{if(t)return{error:e};n=e}return W(o,h=>h[0]=0),u&&u.forEach(h=>C.set(h,r[h])),await Ne(o,!1),n!=null?{data:n}:void 0}function yt(e,t=302){let s,n;typeof t=="number"?s={status:t}:({revalidate:n,...s}=t,typeof s.status>"u"&&(s.status=302));const r=new Headers(s.headers);return r.set("Location",e),n!==void 0&&r.set("X-Revalidate",n.toString()),new Response(null,{...s,headers:r})}function mt(e,t={}){const{revalidate:s,...n}=t,r=new Headers(n.headers);s!==void 0&&r.set("X-Revalidate",s.toString()),r.set("Content-Type","application/json");const o=new Response(JSON.stringify(e),{...n,headers:r});return o.customBody=()=>e,o}const Xe="900da1c8f697beefdab33bc8ff480a1448f58fd015ec3108dc3b323bdaa0c245",Ke=3600*24,ze=_(function(){return He({name:"oaq_explorer_session",password:Xe,maxAge:Ke})},"src_auth_session_ts--getSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),U=ze,Ve=_(async()=>{const{data:e}=await U();return e.usersId?e:null},"src_auth_session_ts--getSessionUser_query","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),wt=C(Ve,"session-user"),Ye=_(async function(t,s){const n=await U();await n.update(r=>(r.usersId=t,r)),await n.update(r=>{r.maxAge=s})},"src_auth_session_ts--setSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),St=Ye,Qe=_(async function(){await(await U()).update(s=>s.usersId=void 0)},"src_auth_session_ts--clearSession_1","C:/Users/MARIAM/Desktop/AirSense/AirSense/src/auth/session.ts?tsr-directive-use-server="),Rt=Qe,f=process.env.REST_API_URL||"http://localhost:8080",bt={createUser:async e=>await fetch(`${f}/users`,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}),getUserById:async e=>await fetch(`${f}/users/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByEmailAddress:async e=>await fetch(`${f}/users/email/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getUserByVerificationCode:async e=>await fetch(`${f}/users/verification-code/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),verifyUser:async e=>await fetch(`${f}/users/${e}/verification`,{method:"PATCH"}),createNewUserToken:async e=>await fetch(`${f}/users/${e}/token`,{method:"POST"}),updateUserPassword:async e=>await fetch(`${f}/users/password`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),createList:async e=>await fetch(`${f}/lists`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),getList:async e=>await fetch(`${f}/lists/${e}`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),updateList:async e=>await fetch(`${f}/lists`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}),deleteList:async e=>await fetch(`${f}/lists/${e}`,{method:"DELETE"}),deleteListLocation:async(e,t)=>await fetch(`${f}/lists/${e}/locations/${t}`,{method:"DELETE"}),getUserLists:async e=>await fetch(`${f}/users/${e}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getLocationLists:async(e,t)=>await fetch(`${f}/users/${e}/locations/${t}/lists`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),getListLocations:async e=>await fetch(`${f}/lists/${e}/locations`,{method:"GET",headers:{"Cache-Control":"no-cache, no-store"}}),createListLocation:async(e,t)=>await fetch(`${f}/lists/${e}/locations`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})};export{ft as a,I as b,wt as c,at as d,ct as e,ut as f,ht as g,it as h,q as i,lt as j,gt as k,_ as l,bt as m,mt as n,St as o,Rt as p,C as q,yt as r,dt as s,Ne as t,pt as u};
