import{isServer as te,ssr as m,ssrHydrationKey as w,escape as t,ssrStyleProperty as z,ssrAttribute as b,ssrElement as A,mergeProps as v,createComponent as n}from"solid-js/web";import{u as T}from"./index-DGFWRD0-.js";import{createSignal as S,splitProps as se,sharedConfig as O,onMount as I,createMemo as U,untrack as re,createEffect as F,Show as L,For as j}from"solid-js";import{a as oe,b as ne,c as ae}from"./index-qVjEDydT.js";import{t as ie,s as le,L as ce,R as de,a as pe,N as ue}from"./index-CMDuqxUV.js";import{isoParse as me,scaleTime as he,line as ve,scaleLinear as ge,min as fe,max as ye}from"d3";import N from"dayjs";import be from"dayjs/plugin/timezone.js";import we from"dayjs/plugin/utc.js";import{C as $e}from"./close-CKxkeldA.js";import{c as Se}from"./backend-fKgEBaUj.js";import{i as E,j as Ce}from"./routing-BPjDSAJ2.js";import{c as xe}from"./createAsync-Dqt8Sub7.js";import{A as Me}from"./components-D-gQuZqx.js";import ke from"minisearch";import{createStore as Pe}from"solid-js/store";import{unified as K}from"unified";import V from"remark-parse";import G from"remark-frontmatter";import J from"remark-parse-frontmatter";import Z from"remark-rehype";import W from"rehype-stringify";import Ae from"crypto-js/md5.js";function R(e,a={}){if(te)return l=>l.fallback;const[c,s]=S();return!a.lazy&&D(e,s),l=>{let p,u;const[,o]=se(l,["fallback"]);if(a.lazy&&D(e,s),(p=c())&&!O.context)return p(o);const[g,r]=S(!O.context);return I(()=>r(!0)),U(()=>(p=c(),u=g(),re(()=>p&&u?p(o):l.fallback)))}}function D(e,a){e().then(c=>a(()=>c.default))}function Q(e){return e.map(a=>({value:parseFloat(a.value),date:me(a.date)}))}var Te=["<svg",' width="','" height="','"><g transform="','"><path style="','"',"></path></g></svg>"];N.extend(we);N.extend(be);function qe(e){const[a,c]=S(Q(e.series)),s=N(new Date,e.timezone).toDate(),l=N(new Date().getTime()-864e5,e.timezone).toDate(),p=he().range([0,e.width]);p.domain([l,s]);const u=()=>{const r=ge().range([e.height,0]);return r.domain([fe(a(),f=>f.value),ye(a(),f=>f.value)]),r};let o=u();const g=ve().x(r=>p(r.date)).y(r=>o(r.value));return F(()=>{c(Q(e.series)),o=u()}),m(Te,w(),`${t(e.width,!0)+t(e.margin.left,!0)+t(e.margin.right,!0)}px`,`${t(e.height,!0)+t(e.margin.top,!0)+t(e.margin.bottom,!0)}px`,`translate(${t(e.margin.left,!0)} ${t(e.margin.top,!0)})`,z("fill:",t(e.style.fill,!0))+z(";stroke:",t(e.style.color,!0))+z(";stroke-width:",t(e.style.width,!0)),b("d",t(g(a()),!0),!1))}var Fe='<path d="m560-240-56-58 142-142H160v-80h486L504-662l56-58 240 240z"></path>';const _e=(e={})=>A("svg",v({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>m(Fe),!0);var Le=["<div",' class="','"><header class="location-detail-card__header"><div><h3 class="type-heading-3 text-white">','</h3></div><div><button class="close-btn"> <!--$-->','<!--/--></button></div></header><div class="location-detail-card__body"><section class="section"><span class="type-body-3">','</span></section><section class="section-grid"><span class="type-subtitle-3">Type</span><span class="type-body-1">','</span><span class="type-subtitle-3">Measures</span><span class="type-body-1">','</span></section><section class="section-grid"><span class="type-subtitle-3">Source</span><span class="type-body-1">','</span><span class="type-subtitle-3">Reporting</span><div class="reporting-cell"><span class="type-body-1">','</span><span class="type-body-4">','</span></div></section><section class="recent-measurements"><span class="type-subtitle-3">Latest Readings </span><span class="type-body-1">(last 24 hours) </span><!--$-->','<!--/--></section></div><footer class="location-detail-card__footer"><!--$-->',"<!--/--><!--$-->","<!--/--></footer></div>"],Ne=["<span",' class="type-subtitle-3">',"</span>"],ze=["<span",' class="type-body-1">Loading...</span>'],Ie=["<span",' class="type-body-1">No recent measurements</span>'];function He(){const e=xe(()=>Se()),a=E(),c={width:24,height:24,fill:"#FFFFFF"},[s,{clearLocationsId:l,setRecentMeasurements:p,updateRecentMeasurements:u}]=T(),[o,g]=S();return F(async()=>{if(s.locationsId){g(await oe(s.locationsId));const r=o().results[0].sensors;p([]);const f=r.map(h=>{const[x,q]=S([]),[M,k]=S(!0);return{parameter:`${h.parameter.displayName} ${h.parameter.units}`,loading:M,setLoading:k,series:x,setSeries:q}});p(f);for(const h of r){const x=await ne(h,o().results[0].timezone);u(`${h.parameter.displayName} ${h.parameter.units}`,x)}}}),m(Le,w(),`location-detail-card ${s.locationsId?"":"location-detail-card--translate"}`,t(o()?.results?.[0].name?.slice(0,20))||"No label",t(n($e,c)),t(o()?.results?.[0].country.name),o()?.results?.[0].isMonitor?"Reference grade":"Air sensor",t(o()?.results?.[0].sensors.map(r=>`${r.parameter.displayName} ${r.parameter.units}`).join(", ")),t(o()?.results?.[0].provider.name),o()?.results?.[0].datetimeLast?`Updated ${t(ie(o()?.results?.[0].datetimeLast?.local))}`:"No measurements",o()?.results?.[0].datetimeFirst?`Reporting since ${t(le(o()?.results?.[0].datetimeFirst?.local))}`:"No measurements",t(n(L,{get when(){return s.recentMeasurements&&o()},get children(){return n(j,{get each(){return s.recentMeasurements},children:(r,f)=>[m(Ne,w(),t(r.parameter)),r.series().length?n(qe,{get series(){return r.series()},get timezone(){return o()?.timezone},width:78,height:14,margin:{top:1,right:1,bottom:1,left:1},style:{color:"#5d48f4",width:"3",fill:"none"}}):r.loading()?m(ze,w()):m(Ie,w())]})}})),t(n(L,{get when(){return e()?.usersId},get children(){return n(ce,{get redirect(){return a.pathname}})}})),t(n(Me,{get href(){return`/locations/${s.locationsId}`},class:"icon-btn btn-primary",get children(){return["Show Details ",n(_e,c)]}})))}var Oe='<path d="M400-240 160-480l240-240 56 58-142 142h486v80H314l142 142z"></path>';const Re=(e={})=>A("svg",v({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>m(Oe),!0);var De='<path d="M200-120q-33 0-56.5-23.5T120-200v-160h80v160h160v80zm400 0v-80h160v-160h80v160q0 33-23.5 56.5T760-120zM120-600v-160q0-33 23.5-56.5T200-840h160v80H200v160zm640 0v-160H600v-80h160q33 0 56.5 23.5T840-760v160z"></path>';const Qe=(e={})=>A("svg",v({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>m(De),!0);var Be=["<button",' class="button-reset zoom-to-provider-btn"><span>Zoom to provider extent </span><!--$-->',"<!--/--></button>"],Ue=["<div",' class="providers-card"><header class="providers-card__header"><!--$-->','<!--/--><h3 class="type-heading-3 text-white">Data providers</h3></header><div class="providers-card__body"><div class="list-header"><div class="select-helpers"><button class="button-reset type-link-1 providers-list-select-all">Select All</button><span>|</span><button class="button-reset type-link-1 providers-list-select-none">Select None</button></div><span><!--$-->',"<!--/--> of <!--$-->","<!--/--> providers selected</span><!--$-->",'<!--/--><input type="text" name="search-input" id="search-input" class="search-input"><span>','</span></div><div class="list-container"><ul class="providers-list">','</ul></div></div><footer class="providers-card__footer"><button class="','"',">Update</button></footer></div>"],je=["<li",' class="providers-list-item"><label for="','" class="type-body-1 text-smoke-120">','</label><input type="checkbox" name="','" id="','"',"",' class="checkbox"></li>'];function Ee(){const[e,{toggleShowProvidersCard:a,setViewport:c,setProviders:s,setTotalProviders:l,setBounds:p,setMapBbox:u}]=T(),[o,g]=S(),[r,f]=Pe([]),[h,x]=S([]),q=()=>{a()},M=new ke({fields:["name"],storeFields:["name"]}),k={width:24,height:24};return I(async()=>{const P=(await ae()).results;g(P.length),l(P.length),f(P.map(C=>({name:C.name,id:C.id,checked:e.providers.length===0?"true":e.providers.includes(C.id),matchesQuery:!0,bbox:C.bbox})).sort((C,i)=>C.name.toLowerCase<i.name.toLowerCase?-1:1)),M.addAll(r)}),F(()=>{x(r.filter(d=>d.checked))}),m(Ue,w(),t(n(Re,v({fill:"#FFFFFF"},k,{onClick:()=>q()}))),t(h().length),`${t(o())}`,t(n(L,{get when(){return h().length!=o()&&h().length!=0},get children(){return m(Be,w(),t(n(Qe,v({fill:"#5a6672"},k))))}})),r.filter(d=>d.matchesQuery).length==o()?`Listing all ${t(o())} providers`:`Listing ${t(r.filter(d=>d.matchesQuery).length)} of ${t(o())} providers`,t(n(j,{get each(){return r.filter(d=>d.matchesQuery)},children:(d,P)=>{if(d.matchesQuery)return m(je,w(),`${t(d.name,!0)}-checkbox`,t(d.name),`${t(d.name,!0)}-checkbox`,`${t(d.name,!0)}-checkbox`,b("value",t(d.id,!0),!1),b("checked",d.checked,!0))}})),`btn btn-primary ${h().length>0?"":"btn-primary--disabled"}`,b("disabled",h().length===0,!0))}var Ke='<path d="M440-160q-17 0-28.5-11.5T400-200v-240L168-736q-15-20-4.5-42t36.5-22h560q26 0 36.5 22t-4.5 42L560-440v240q0 17-11.5 28.5T520-160zm40-308 198-252H282zm0 0"></path>';const Ve=(e={})=>A("svg",v({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>m(Ke),!0);var Ge='<path d="M440-120v-240h80v80h320v80H520v80zm-320-80v-80h240v80zm160-160v-80H120v-80h160v-80h80v240zm160-80v-80h400v80zm160-160v-240h80v80h160v80H680v80zm-480-80v-80h400v80z"></path>';const Je=(e={})=>A("svg",v({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>m(Ge),!0);var Ze='<path d="M478-240q21 0 35.5-14.5T528-290t-14.5-35.5T478-340t-35.5 14.5T428-290t14.5 35.5T478-240m-36-154h74q0-33 7.5-52t42.5-52q26-26 41-49.5t15-56.5q0-56-41-86t-97-30q-57 0-92.5 30T342-618l66 26q5-18 22.5-39t53.5-21q32 0 48 17.5t16 38.5q0 20-12 37.5T506-526q-44 39-54 59t-10 73m38 314q-83 0-156-31.5T197-197t-85.5-127T80-480t31.5-156T197-763t127-85.5T480-880t156 31.5T763-763t85.5 127T880-480t-31.5 156T763-197t-127 85.5T480-80m0-80q134 0 227-93t93-227-93-227-227-93-227 93-93 227 93 227 227 93m0-320"></path>';const We=(e={})=>A("svg",v({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 -960 960 960"},e),()=>m(Ze),!0),Xe={width:24,height:24},Ye=({content:e,title:a})=>{const[c,{toggleShowHelpCard:s,setHelpContent:l}]=T(),p=u=>{s(!0),l(e),u.stopPropagation()};return n(We,v(Xe,{fill:"#000000",class:`${a} help-icon`,onClick:u=>p(u)}))},et=`---\r
title: 'pollutants'\r
---\r
\r
### Pollutants\r
\r
The OpenAQ database currently ingests the following pollutant data, with a focus on those in **bold**.\r
\r
- PM<sub>1</sub> - particulate matter 1 microns (μm)\r
- **PM<sub>2.5</sub> - particulate matter 2.5 microns (μm)**\r
- PM<sub>4</sub> - particulate matter 4 microns (μm)\r
- **PM<sub>10</sub> - particulate matter 10 microns (μm)**\r
- **BC - black carbon particulates, part of PM2.5**\r
- **O₃ - Ozone gas**\r
- **CO - Carbon monoxide gas**\r
- **NO₂ - Nitrogen dioxide gas**\r
- NO - Nitrogen monoxide gas\r
- NO<sub>x</sub> - Nitrogen oxides\r
- **SO₂ - Sulfur dioxide gas**\r
- CH₄ - Methane gas\r
- CO₂ - Carbon dioxide gas\r
\r
### Units of measurement\r
\r
Measurements of pollutants are reported in a variety of units depending on how the data is reported from the original data provider. The most common units found in the dataset are:\r
\r
- ppb (parts per million)\r
- µg/m³ (micrograms per cubic meter)\r
\r
Units are not normalized in the OpenAQ system, with the exception of converting ppb (parts per billion) to ppm (parts per million). Volume units are not converted to mass units, nor vice versa; they are served as originally reported.\r
`,tt=e=>{const{data:{frontmatter:a},value:c}=K().use(V).use(G,["yaml"]).use(J).use(Z).use(W).processSync(e),s=a;return{notificationContent:String(c),notificationTitle:s?.title,notificationType:s?.type}},st=e=>{const{data:{frontmatter:a},value:c}=K().use(V).use(G,["yaml"]).use(J).use(Z).use(W).processSync(e),s=a;return{helpContent:String(c),helpTitle:s?.title}};var rt=["<div",' class="overlay-card"><section class="filter-section"><header class="filter-section__header"><div class="card-title"><!--$-->','<!--/--><h3>Filters</h3></div></header><div class="pollutant-select"><div class="pollutant-label-wrapper"><label for="parameter-select" class="type-subtitle-2">Choose a pollutant </label><span>','</span></div><select class="select" name="parameter-select" id="parameter-select"','><option value="all">Any pollutant</option><option value="pm25">PM&#8322;&#8325;</option><option value="pm10">PM&#8321;&#8320;</option><option value="o3">O&#8323;</option><option value="no2">NO&#8322;</option><option value="so2">SO&#8322;</option><option value="co">CO</option></select></div><hr class="hr"><div><span class="type-subtitle-2">Choose location type</span><div class="filter-section__body"><!--$-->','<!--/--><label class="marker-legend-item" for="reference-grade"><span>Reference monitor locations</span><input type="checkbox" name="reference-grade" id="reference-grade" class="checkbox"',"","></label><!--$-->",'<!--/--><label class="marker-legend-item" for="low-cost-sensor">Air sensors locations<input type="checkbox" name="low-cost-sensor" id="low-cost-sensor" class="checkbox"',"","></label><!--$-->",'<!--/--><label class="marker-legend-item" for="no-recent-updates">Show locations with no recent updates<input type="checkbox" name="no-recent-updates" id="no-recent-updates" class="checkbox"','></label></div></div></section><footer class="overlay-card__footer"><span class="type-body-1">Showing data from <!--$-->','<!--/--></span><button class="icon-btn btn-secondary">Choose data providers <!--$-->',"<!--/--></button></footer></div>"];const X=st(et),ot=X.helpContent,nt=X.helpTitle;function at(){const[e,{toggleShowProvidersCard:a,setSelectedMapParameter:c,toggleMapIsActive:s,toggleAirSensor:l,toggleMonitor:p}]=T(),u={width:24,height:24};return m(rt,w(),t(n(Ve,v(u,{fill:"#FFFFFF"}))),t(n(Ye,{content:ot,title:nt})),b("value",t(e.mapParameter.toString(),!0),!1),t(n(de,{})),b("checked",e.showMonitors,!0),b("disabled",!e.showAirSensors,!0),t(n(pe,{})),b("checked",e.showAirSensors,!0),b("disabled",!e.showMonitors,!0),t(n(ue,{})),b("checked",!e.showOnlyActiveLocations,!0),e.providers.length==0?"all providers":e.providers.length==1?"1 provider":`${t(e.providers.length)} providers`,t(n(Je,v(u,{fill:"#33a3a1"}))))}var it=["<div",' class="','"><div class="flip-card-inner"><div class="flip-card-front">','</div><div class="flip-card-back">',"</div></div></div>"];function lt(){const[e]=T();return m(it,w(),`flip-card ${e.showProvidersCard?"flip-card--active":""} ${e.locationsId||e.showHelpCard?"flip-card--translate":""}`,t(n(at,{})),t(n(Ee,{})))}const B=`---\r
title: 'Registration issues'\r
type: 'warning'\r
---\r
\r
The OpenAQ Explorer is currently experiencing issues with new account\r
registration. Existing accounts can login as usual. If you need to register for\r
an accout please try again later.\r
`;function _t(){const[e,a]=S(null),c=JSON.parse(!1),[s,l]=T(),p=R(()=>import("./NotificationCard-D17mnV_-.js")),u=R(()=>import("./HelpCard-BeJqItB8.js")),g=`${Ae(B).toString()}-notificationDismissed`,r=tt(B),f=r.notificationType,h=r.notificationTitle,x=r.notificationContent;F(()=>{const y=localStorage.getItem(g)==="true";c&&!y&&l.toggleShowNotificationCard(!0),(y||!c)&&l.toggleShowNotificationCard(!1)});const q=l.setSelectedLocationsId,M=l.setSelectedMapParameter,k=l.setProviders,d=l.toggleMapIsActive,P=l.toggleMonitor,C=l.toggleAirSensor,i=E(),Y=Ce();return I(()=>{if(i.query.location&&q(Number(i.query.location)),i.query?.parameter&&(Array.isArray(i.query.parameter)&&i.query.parameter.length===0?M(i.query.parameter[0]):typeof i.query.parameter=="string"&&M(i.query.parameter)),i.query?.active){const y=i.query.active==="true";s.showOnlyActiveLocations!==y&&d()}if(i.query?.sensors){const y=i.query.sensors==="true";s.showAirSensors!==y&&C()}if(i.query?.monitors){const y=i.query.monitors==="true";s.showMonitors!==y&&P()}if(i.query?.provider){const _=new URLSearchParams(i.search).get("provider")?.split(",").map($=>Number($));_&&k(_)}}),F(()=>{const _=U(()=>s.providers)(),$=new URLSearchParams;s.locationsId!==void 0&&$.append("location",s.locationsId.toString()),s.mapParameter!=="all"&&$.append("parameter",s.mapParameter.toString()),_.length>0&&$.append("provider",s.providers.join(",")),s.showOnlyActiveLocations==!1&&$.append("active",s.showOnlyActiveLocations.toString()),s.showMonitors==!1&&$.append("monitors",s.showMonitors.toString()),s.showAirSensors==!1&&$.append("sensors",s.showAirSensors.toString());const H=$.toString(),ee=H?`${i.pathname}?${H}${i.hash}`:`${i.pathname}${i.hash}`;Y(ee)}),[n(L,{get when(){return c&&s.showNotificationCard},get children(){return n(p,{notificationType:f,notificationTitle:h,notificationContent:x,dismissedKey:g})}}),n(u,{get content(){return s.helpContent},title:"Help"}),n(lt,{}),n(He,{})]}export{_t as H,_e as R};
